# SQL & ORM



## Database

체계화된 데이터의 모임

몇개의 자료 파일을 **조직적**으로 통합, 자료 항목의 중복 없애고 자료를 **구조화**하여 기억시켜 놓은 자료의 **집합체**

### RDB

관계형 데이터베이스

키와 값들의 간단한 관계를 표형태로 데이터베이스(표를 관계라고 하기도 한다 ex:엑셀)

스키마 - 데이터베이스에서 자료의 전반적인 명세를 기술

테이블 - 열과 행의 모델을 사용해 조직된 데이터 요소들의 집합(행 1줄이 데이터 1개를 의미하게됨)

기본키 - 각행의 고유값(반드시 설정해야하고 관계 설정시에도 주요하게 활용)



### RDBMS

관계형 모델을 기반으로 하는 데이터베이스 관리시스템

ex: MySQL, SQLite, ORACLE...

#### SQLite

서버 형태가 아니라 파일 형식으로 응용 프로그램에 넣어서 사용하는 비교적 가벼운 데이터베이스

안드로이드 운영체제에 기본탑재된 데이터베이스

로컬에서 간단한 DB 구성이 가능

* SQLite Data Type

1. NULL - 데이터가 없음을 표현 
2. INTEGER
3. REAL - 8바이트 부동 소수점 숫자로 저장된 부동 소수점 값
4. TEXT
5. BLOB - 별다른 타입 없이 그대로 저장하는 데이터

SQLite Type 선호도(특정 컬럼에 저장하도록 권장하는 데이터 타입)이 존재



## SQL

관리시스템의 데이터 관리를 위해 설계된 특수 목적의 프로그래밍 언어

데이터베이스 스키마 생성 및 수정

데이터베이스 객체 접근 조정 관리

* 분류

1. DDL - 정의(ex: CREATE, DROP, ALTER)
2. DML - 조작(INSERT, SELECT, UPDATE, DELETE)  CRUD(추가, 조회, 갱신, 삭제)와 같다
3. DCL - 제어



SQLite에서는 ; 도 필수적인 요소

not null이 필요한 경우는 스키마를 지정할 때 입력해줘야한다

primary key 작성시에는 INT라고 하면 안되고 INTEGER라고 적어줘야한다

ID값을 직접 작성해버리면 에러가 날 수 있다(스키마에 지정하지 않으면 rowid값 자동으로 생성됨)

저장하고 새로고침 해줘야 결과 볼 수 있다

블록지정안해도 ;끝나는 지점에서 RUN SELECTED QUERY 해주면 그 문장이 실행된다

CREATE는 테이블 생성 , INSERT INTO는 데이터 생성

----

조회가 데이터베이스에서는 가장 중요(잘 가져오는것이 가장 중요하기 때문)

SELECT문 - SQLite에서 가장 복잡한 문이며 다양한 절과 함께 사용

LIMIT - 쿼리에서 반환하는 행 수를 제한(특정 행부터 시작해서 조회 - OFFSET 키워드와 같이 사용 --- 처음이 0부터 시작된다고 생각하면 편하다)

* OFFSET

위치의 변화량을 나타내는 정수형

2라고 하면 3부터 시작한다는 뜻



WHERE - (IF문과 비슷) 특정 검색 조건을 지정함

SELECT DISTINCT - 조회 결과에서 중복 행을 제거 

----

DELETE FROM 테이블이름 WHERE 조건;

지우고 다시 추가하면 id를 재사용한다(Django와는 다르다)

재사용 없이 사용하지 않은 다음 행 값을 사용하게 하려면 AUTOINCREMENT라는 속성값을 테이블 생성단계에서 PRIMARY KEY뒤에 추가해줘야함(장고는 기본적으로 추가되어 있다)

ORM이 SQL문을 쓰지 않고도 알아서 다 도와줬다는 뜻(python manage.py sqlmigrate 명령어로 확인가능)

새로운 데이터타입이 등장하면 기존 테이블을 삭제하고 새로운 테이블을 만들어서 생성하는것

----

UPDATE는 SET절이 필요

UPDATE 테이블이름 SET 컬럼1=값1, .... WHERE 조건;

중복불가능한 값인 rowid를 기준으로 수정!!



----

Aggregate function

집계함수

값 집합에 대한 계산을 수행하고 단일 값을 반환

**여러행으로부터 하나의 결과값 반환**

**SELECT 구문에서만 사용됨**

ex: COUNT(*) , AVG(age), MAX, MIN, SUM



----

LIKE operator

패턴일치를 기반으로 데이터를 조회하는 방법

2개의 wild cards 제공(파일을 지정할 때 구체적인 이름 대신 여러파일 동시에 지정할 목적 ex: *, ? 등 )

유사하지만 동일한 데이터가 아닌 여러항목을 찾기에 매우 편리

* %

0개 이상의문자(문자열이 있을수도 없을수도 있다)

* _(언더바)

반드시 이 자리에 한개의 문자가 존재해야한다

---

ORDER BY

조회 결과 집합을 정렬

SELECT문에 추가하여 사용

ASC - 오름차순(기본값이라 생략가능)

DESC - 내림차순

ORDER BY 기준이 여러개라면 먼저 작성한거부터 정렬(age, last_name하면 age기준으로 미리 정렬되고 그 age안에서 last_name기준 정렬)

----

GROUP BY

행 집합에서 요약 행 집합을 만듬

SELECT 문의 optional 절

별도의 집합 컬럼을 하나 더 만든다는 뜻

선택된 행 그룹을 하나 이상의 열값으로 요약 행으로 만듬

**WHERE 절이 포함된 경우 반드시 WHERE 절 뒤에 작성**

데이터를 요약하는 상황에 주로 사용

----

ALTER TABLE

1. table 이름 변경

2. 테이블에 새로운 column 추가

3. column 이름 수정

4. drop column(최근 추가됨)